FROM kalilinux/kali-rolling:latest
# Properties
LABEL description="Web Application Vulerability Assessment customized toolbox based on a KALI image"
# Install system packages
RUN apt-get update && apt-get install -y autoconf aha apache2 automake bsdmainutils build-essential curl dnsutils git iputils-ping libauthen-pam-perl libcurl4 libcurl4-openssl-dev libffi-dev libgeoip-dev libimage-exiftool-perl libio-pty-perl libnet-ssleay-perl libsqlite3-dev libtool locales nmap nodejs openssl python-dev perl python3 python3-dev python3-pip ruby ruby-dev unzip vim wafw00f wget whois zlib1g-dev zip zsh
# Fix error with Ruby during Beef Installation
RUN ls -l /usr/bin/ruby
RUN ln /usr/bin/ruby /usr/bin/ruby2.5
# Install tools
RUN mkdir -p /tools/reports
RUN git clone --depth 1 https://github.com/drwetter/testssl.sh /tools/testssl
RUN git clone --depth 1 https://github.com/meliot/shcheck.git /tools/shcheck
RUN git clone --depth 1 https://github.com/mpgn/Padding-oracle-attack /tools/padding-oracle-attack
RUN git clone --depth 1 https://github.com/sullo/nikto.git /tools/nikto
RUN git clone --depth 1 https://github.com/dxa4481/truffleHog.git /tools/truffle-hog
RUN git clone --depth 1 https://github.com/maaaaz/nmaptocsv.git /tools/nmap-to-csv
RUN git clone --depth 1 https://github.com/honze-net/nmap-bootstrap-xsl.git /tools/nmap-bootstrap-xsl
RUN git clone --depth 1 https://github.com/danielmiessler/SecLists.git /tools/sec-lists
RUN git clone --depth 1 https://github.com/maurosoria/dirsearch.git /tools/dirsearch
RUN git clone --depth 1 https://github.com/psypanda/hashID.git /tools/hash-id
RUN git clone --depth 1 https://github.com/trimstray/htrace.sh.git /tools/htrace
RUN git clone --depth 1 https://github.com/darkoperator/dnsrecon.git /tools/dnsrecon
RUN git clone --depth 1 https://github.com/aboul3la/Sublist3r /tools/sublist3r
RUN git clone --depth 1 https://github.com/stamparm/identYwaf.git /tools/identYwaf
RUN git clone --depth 1 https://github.com/danielmiessler/RobotsDisallowed.git /tools/robots-disallowed
RUN git clone --depth 1 https://github.com/elceef/dnstwist.git /tools/dnstwist
RUN git clone --depth 1 https://github.com/righettod/tls-cert-discovery.git /tools/tls-cert-discovery
RUN git clone --depth 1 https://github.com/righettod/website-passive-reconnaissance.git /tools/website-passive-reconnaissance
RUN git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git /tools/sqlmap
# Install utility scripts
COPY scripts /tools/scripts
RUN chmod +x /tools/scripts/*.sh
# Install dependencies for tools
RUN BUILD_LIB=1 pip3 install ssdeep
RUN for f in $(ls /tools/*/requirements.txt); do pip3 install -r $f; done
RUN tldextract --update
# Install BEEF + Reverse Proxy configuration
# BEEF
ENV LANG en_US.UTF-8
ENV LANGUAGE en_US:en
ENV LC_ALL en_US.UTF-8
RUN locale-gen en_US.UTF-8 && sed -i -e 's/# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/locale.gen
RUN echo 'LANG="en_US.UTF-8"' > /etc/default/locale
RUN dpkg-reconfigure --frontend=noninteractive locales && update-locale LANG=en_US.UTF-8
RUN git clone --depth 1 https://github.com/beefproject/beef /tools/beef
RUN cd /tools/beef && gem install bundler && bundle install && sed -i 's/passwd: "beef"/passwd: "beefbeef"/g' config.yaml
## Apache RP
RUN a2enmod ssl proxy proxy_http substitute
COPY beef /tools/beef-conf
RUN chmod +x /tools/beef-conf/*.sh
RUN rm /etc/apache2/sites-enabled/000-default.conf && ln -s /tools/beef-conf/beef-https-rp-config.conf /etc/apache2/sites-enabled/000-beef.conf
RUN apachectl configtest
# Set final settings of the toolbox
RUN echo 'alias ll="ls -rtl"' >> /root/.bashrc
WORKDIR /tools
VOLUME /tools/reports
EXPOSE 80
EXPOSE 443
