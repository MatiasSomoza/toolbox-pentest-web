#!/bin/bash
###########################################################################################################
# Script to identify backup copy of files.
#
# For example, it can be used to find a copy of a file that has the suffix -YYYYMMDD or .swp for example.
#
# The script use a list of files name/web-path to use as base like for example "sites/default/settings.php".
#
# System dependencies to install via the package manager:
#   wfuzz
###########################################################################################################
if [ "$#" -lt 2 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [BASE_FILE_DICT] [BASE_URL_WITHOUT_ENDING_SLASH] "
    echo ""
    echo "Call example:"
    echo "   $script_name /tmp/drupal-files.txt https://mysite.com "
    exit 1
fi
basedict=$1
baseurl=$2
cd /tools/scripts
echo -e "\e[93mGenerate extensions global dict...\e[0m"
extensions_file="/tmp/ext.tmp"
./generate-backup-extensions-dict.py -y 5 -o $extensions_file
cat /tools/sec-lists/Discovery/Web-Content/web-mutations.txt >> $extensions_file
wc -l $extensions_file
echo -e "\e[93mPerform the discovery...\e[0m"
wfuzz -c -w $basedict -w $extensions_file --sc 200 "$baseurl/FUZZFUZ2Z"
