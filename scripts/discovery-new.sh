#!/bin/bash
extensions="jsp php html htm js txt asp aspx"
ignore_http_codes="400 401 403 405"
ua="Firefox/86.0"
opts="--quiet --redirects --auto-tune --insecure --depth 10 --extensions $extensions --filter-status $ignore_http_codes --threads 20  --timeout 10 --user-agent $ua"
dicts=( "common.txt" "graphql.txt" "swagger.txt" "Common-DB-Backups.txt" )
for dict in ${dicts[@]}; do
	echo -e "\e[93m[+] Test using '$dict'...\e[0m"
	/usr/bin/feroxbuster $opts --wordlist /tools/sec-lists/Discovery/Web-Content/$dict --url $1
done
dict="directory-list-2.3-medium.txt"
echo -e "\e[93m[+] Test using NUCLEI 'exposures/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/exposures -u $1
echo -e "\e[93m[+] Test using NUCLEI 'exposed-panels/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/exposed-panels -u $1
echo -e "\e[93m[+] Test using NUCLEI 'technologies/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/technologies -u $1
echo -e "\e[93m[+] Test using NUCLEI 'misconfiguration/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/misconfiguration -u $1
echo -e "\e[93m[+] Test using '$dict'...\e[0m"
/usr/bin/feroxbuster $opts --wordlist /tools/sec-lists/Discovery/Web-Content/$dict --url $1
