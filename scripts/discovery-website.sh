#!/bin/bash
extensions=".jsp,.php,.html,.htm,.js,.txt,.asp,.aspx"
ignore_http_codes="400,403,404"
opts="-c -e $extensions --fc $ignore_http_codes -ic -r -recursion -recursion-depth 10 --timeout 10"
dicts=( "common.txt" "big.txt" "quickhits.txt" "graphql.txt" "swagger.txt" "Common-DB-Backups.txt" )
for dict in ${dicts[@]}; do
	echo -e "\e[93m[+] Test using '$dict'...\e[0m"
	ffuf $opts -w /tools/sec-lists/Discovery/Web-Content/$dict -u $1/FUZZ
done
echo -e "\e[93m[+] Test using NUCLEI 'exposures/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/exposures -u $1
echo -e "\e[93m[+] Test using NUCLEI 'exposed-panels/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/exposed-panels -u $1
echo -e "\e[93m[+] Test using NUCLEI 'technologies/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/technologies -u $1
echo -e "\e[93m[+] Test using NUCLEI 'misconfiguration/*' templates...\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/misconfiguration -u $1
dict="directory-list-2.3-medium.txt"
echo -e "\e[93m[+] Test using '$dict'...\e[0m"
ffuf $opts -w /tools/sec-lists/Discovery/Web-Content/$dict -u $1/FUZZ
