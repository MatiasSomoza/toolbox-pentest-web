#!/bin/bash
############################################################################
# Script to identify if a WAF is present in front of a web app
############################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [URL]"
    echo ""
    echo "Call example:"
    echo "    $script_name \"https://righettod.eu\""
    exit 1
fi
url=$1
# https://github.com/EnableSecurity/wafw00f
echo -e "\e[93m[+] Test using WAFW00F...\e[0m"
wafw00f $url | grep --color=never " WAF "
# https://github.com/stamparm/identYwaf
echo -e "\e[93m[+] Test using IDENTYWAF...\e[0m"
python3 /tools/identYwaf/identYwaf.py $url | grep --color=never "blind match"
echo -e "\e[93m[+] Test using CURL with explicit payloads in a HTTP GET request...\e[0m"
# %27%20or%201%3D1%20%2D%2D%20 ===> ' or 1=1 -- 
echo -n "[*] SQL injection payload: "
curl -A "Mozilla 5/0" -sk -o /dev/null -w '%{http_code}' $url"?payload=%27%20or%201%3D1%20%2D%2D%20"
echo ""
# %3Cscript%20src%3D%27%2F%2Frighettod%2Eeu%2Fs%2Ejs%27%3E%3C%2Fscript%3E ===> <script src='//righettod.eu/s.js'></script>
echo -n "[*] XSS injection payload: "
curl -A "Mozilla 5/0" -sk -o /dev/null -w '%{http_code}' $url"?payload=%3Cscript%20src%3D%27%2F%2Frighettod%2Eeu%2Fs%2Ejs%27%3E%3C%2Fscript%3E"
echo ""
# Normal request
echo -n "[*] NO  injection payload: "
curl -A "Mozilla 5/0" -sk -o /dev/null -w '%{http_code}' $url"?payload=42"
echo ""
