#!/bin/bash
###########################################################################################################
# Script to generate a common DB of FAVICON MurmurHash values
# using GitHub repositories already providing the information as well as Shodan.
#
# See https://isc.sans.edu/diary/Hunting+phishing+websites+with+favicon+hashes/27326
###########################################################################################################
curl -ksq https://raw.githubusercontent.com/devanshbatham/FavFreak/master/favfreak.py | grep -E '[0-9\-]+:\".*\"' | sed -e 's/^[ \t]*//' | tr -d "," > favicon-db.txt
curl -ksq https://raw.githubusercontent.com/sansatart/scrapts/master/shodan-favicon-hashes.csv | cut -d',' -f1-2 | sed 's/,/:/g' | grep -E '[0-9\-]+:\".*\"' >> favicon-db.txt
curl -ksq https://faviconmap.shodan.io/data/favicons.json | jq --raw-output '.[] | "\(.hash):\"See https://www.shodan.io/search?query=http.favicon.hash%3A\(.hash)\""' >> favicon-db.txt
sort -u favicon-db.txt > favicon-db.txt.tmp
mv favicon-db.txt.tmp favicon-db.txt
wc -l favicon-db.txt
