#!/bin/bash
############################################################################
# Script to identify the framework used by the app based on its favicon
############################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [FAVICON_BASE_URL]"
    echo ""
    echo "Call example:"
    echo "    $script_name https://righettod.eu"
    exit 1
fi
FAVICON_FULL_URL=$1
echo -e "\e[93m[+] Favicon MurmurHash:\e[0m"
mmh=$(python3 -c "import requests,mmh3,base64;requests.packages.urllib3.disable_warnings(requests.packages.urllib3.exceptions.InsecureRequestWarning);r=requests.get('$FAVICON_FULL_URL/favicon.ico',verify=False);f=base64.encodebytes(r.content);print(mmh3.hash(f))")
echo $mmh
echo -e "\e[93m[+] Matches in the local DB:\e[0m"
grep -- "$mmh" /tools/favicon-db/favicon-db.txt
echo -e "\e[93m[+] Try identification using NUCLEI 'favicon-detection' template:\e[0m"
nuclei -silent -t $NUCLEI_TPL_HOME/technologies/favicon-detection.yaml -u $FAVICON_FULL_URL
