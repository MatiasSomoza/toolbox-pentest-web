#!/bin/bash
############################################################################
# Script to identify the framework used by the app based on its favicon
############################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [FAVICON_FULL_URL]"
    echo ""
    echo "Call example:"
    echo "    $script_name https://righettod.eu/favicon.ico"
    exit 1
fi
FAVICON_FULL_URL=$1
echo -e "\e[93m[+] Favicon MurmurHash:\e[0m"
mmh=$(python3 -c "import mmh3;print(mmh3.hash('$FAVICON_FULL_URL'))")
echo $mmh
echo -e "\e[93m[+] Matches in the local DB:\e[0m"
grep $mmh /tools/favicon-db/favicon-db.txt