#!/bin/bash
###########################################################################################################
# Script to perform a vulnerability scan using NUCLEI templates specified
###########################################################################################################
# See https://nuclei.projectdiscovery.io/nuclei/get-started
if [ "$#" -lt 2 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [TEMPLATE_FILE_OR_FOLDER] [URL]"
    echo ""
    echo "Call example:"
    echo "    $script_name misconfiguration/drupal https://righettod.eu"
    echo "    $script_name misconfiguration/drupal/drupal-user-enum-ajax.yaml https://righettod.eu"
    exit 1
fi
templates=$1
url=$2
echo "[i] Templates home: $NUCLEI_TPL_HOME"
nuclei -t $NUCLEI_TPL_HOME/$templates -u $url