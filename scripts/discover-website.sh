#!/bin/bash
###
PROXY=""
###
if [ "$PROXY" != "" ];
then
	dirsearch_proxy="--proxy=$PROXY"
else
	dirsearch_proxy=""
fi
extensions=".jsp,.php,.html,.htm,.js,.txt,.asp,.aspx"
ignore_http_codes="400,401,403,404"
# --exclude-sizes=SIZES / --exclude-texts=TEXTS / --exclude-regex=REGEX
opts="-q -f -e $extensions -t 10 -r --deep-recursive -R 5 -x $ignore_http_codes -F --timeout=30 $dirsearch_proxy"
dicts=("quickhits.txt" "common.txt" "graphql.txt" "swagger.txt" "spring-boot.txt" "axis.txt" "Common-DB-Backups.txt" "big.txt" "combined_words.txt")
for dict in ${dicts[@]}; do
	entries_count=$(wc -l /tools/sec-lists/Discovery/Web-Content/$dict | cut -d' ' -f1)
	echo -e "\e[93m[+] Test using '$dict' ($entries_count entries) ...\e[0m"
	python3 /tools/dirsearch/dirsearch.py $opts -w /tools/sec-lists/Discovery/Web-Content/$dict -u $1
done
