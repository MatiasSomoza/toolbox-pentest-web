#!/bin/bash
###########################################################################################################
# Script to identify vulnerabilities in a public key using the tool "https://github.com/badkeys/badkeys".
# See https://badkeys.info/
###########################################################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [DOMAIN_AND_PORT]"
    echo ""
    echo "Call example:"
    echo "   $script_name righettod.eu:443"
    exit 1
fi
TARGET=$1
cd /tools/badkeys
openssl s_client -connect $TARGET 2>/dev/null </dev/null |  sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' > /tmp/cert.pem
./badkeys-cli -v /tmp/cert.pem
