#!/bin/bash
maindomain=$1
echo -e "\e[93mBASE DOMAIN: $maindomain\e[0m"
echo -e "\e[93m[+] Lookup in Certificate Transparency log...\e[0m"
curl -sk "https://crt.sh/?q=$maindomain&output=json" | jq -r ".[].name_value" | grep -v "*" | sort -u > /tmp/subdomains.txt
wc -l /tmp/subdomains.txt
echo -e "\e[93m[+] Discover via GoBuster with SecLists DNS dictionaries...\e[0m"
gobuster -z -q -w /tools/sec-lists/Discovery/DNS/subdomains-top1million-20000.txt dns --wildcard -d $maindomain >> /tmp/subdomains.txt
gobuster -z -q -w /tools/sec-lists/Discovery/DNS/namelist.txt dns --wildcard -d $maindomain >> /tmp/subdomains.txt
wc -l /tmp/subdomains.txt
echo -e "\e[93m[+] Filter results...\e[0m"
cat /tmp/subdomains.txt | sed "s/Found: //g" | sed "s/\r//g" | sed "s/[[:space:]]*$//" | sort -u
