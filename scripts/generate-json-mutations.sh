#!/bin/bash
###########################################################################################################
# Script to generate mutations of a JSON source.
#
# Requirement sotware:
#   jdam: https://gitlab.com/michenriksen/jdam
###########################################################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [JSON_SOURCE_FILE] [MUTANT_COUNTS]"
    echo ""
    echo "[i] MUTANT_COUNTS is optional and default value is 100."
    echo ""
    echo "Call example:"
    echo "    $script_name /tmp/base.json"
    echo "    $script_name /tmp/base.json 1000"
    exit 1
fi
export PATH=$PATH:/tools/jdam
base=$1
count=100
result="/tmp/mutants.txt"
if [ "$#" -eq 2 ]; then
  count=$2
fi
echo "[+] Generate $count mutant from file '$base'..."
cat $base | jdam -count $count > $result
echo "[+] Mutants generated to file '$result' - One mutant by line."
