#!/bin/bash
############################################################################
# Script to identify a class into the libs used by the applications
############################################################################
if [ "$#" -lt 2 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [CLASS_COMPLETE_NAME] [APP_LIBS_FOLDER]"
    echo ""
    echo "Call example:"
    echo "    $script_name \"eu.righettod.MyClass\" /tmp/app-jars"
    exit 1
fi
# Set here the folder path in which all the JAR files of the app were copied 
TARGET_CLASS_NAME=$(echo $1 | tr . /).class
APP_LIBS_FOLDER=$2
LIBS_COUNT=$(ls $APP_LIBS_FOLDER/*.jar | wc -l)
echo -e "\e[93m[+] Searching class '$TARGET_CLASS_NAME' accross $LIBS_COUNT libraries...\e[0m"
find=0
i=0
for lib in $APP_LIBS_FOLDER/*.jar
do
    i=$((i+1))
    echo -ne "\rInspecting file $i/$LIBS_COUNT..."
    find=$(jar tf $lib | grep -c "$TARGET_CLASS_NAME")
    if [ $find -ne 0 ]
    then
        echo ""
        echo -e "\e[92m[!] Class found in the file '$(basename $lib)'.\e[0m"
        break
    fi
done
if [ $find -eq 0 ]
then
    echo ""
    echo -e "\e[91m[!] Class not found!\e[0m"
fi