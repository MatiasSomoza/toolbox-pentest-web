#!/bin/bash
############################################################################
# Script to identify all UUIDs in a code base
############################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [BASE_BASE_FOLDER]"
    echo ""
    echo "Call example:"
    echo "    $script_name /tmp/my-code"
    exit 1
fi
CODE_FOLDER=$1
CDIR=$(pwd)
WORK="/tmp/uuid.tmp"
cd $CODE_FOLDER
# Extract all UUID from a code base excluding test related files
echo -e "\e[93m[+] UUIDs:\e[0m"
grep -IPor ".*[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}.*" * | grep -iv test | grep -Po "[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}" | sort -u > $WORK
cat $WORK
# Extract all UUID from a code base excluding test related files and display the versions of the UUIDs
echo -e "\e[93m[+] VERSIONS:\e[0m"
cat $WORK | cut -d'-' -f3 | cut -c1 | sort -u
rm $WORK
cd $CDIR
