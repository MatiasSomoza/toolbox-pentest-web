#!/bin/bash
###########################################################################################################
# Script to perform discovery of Virtual Hosts (VHOSTS) via brute forcing.
#
# System dependencies to install via the package manager:
#   wfuzz
###########################################################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [IP:PORT]"
    echo ""
    echo "[i] PORT is optional."
    echo ""
    echo "Call example:"
    echo "    $script_name 10.10.10.10"
    echo "    $script_name 10.10.10.10:8000"
    exit 1
fi
ip=$1
wfuzz -c -w /tools/sec-lists/Discovery/DNS/namelist.txt -H "Host: FUZZ" --hc 400,403 https://$ip
wfuzz -c -w /tools/sec-lists/Discovery/DNS/sortedcombined-knock-dnsrecon-fierce-reconng.txt -H "Host: FUZZ" --hc 400,403 https://$ip
