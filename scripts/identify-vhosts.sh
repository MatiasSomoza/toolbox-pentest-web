#!/bin/bash
###########################################################################################################
# Script to perform discovery of Virtual Hosts (VHOSTS) via brute forcing.
#
# System dependencies to install via the package manager:
#   wfuzz
###########################################################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [IP:PORT] [ROOT_DOMAIN]"
    echo ""
    echo "[i] PORT is optional."
    echo "[i] ROOT_DOMAIN is optional."
    echo ""
    echo "Call example:"
    echo "    $script_name 10.10.10.10"
    echo "    $script_name 10.10.10.10:8000"
    echo "    $script_name 10.10.10.10 righettod.eu"
    exit 1
fi
root_domain=""
ip=$1
if [ "$#" -eq 2 ]; then
  root_domain=".$2"
  echo "[+] Add the root domain suffix to the HOST header: $root_domain"
fi
extra_opts=""
echo "[+] Hide response with a specific length (count of characters)?"
echo -n "If yes enter the length otherwise press ENTER: "
read x
if [ "$x" == "" ]; then
  filter_opt="c=200"
else
  filter_opt="h!=$x and c=200"
fi
echo "Add filter: $filter_opt"
echo "[+] Launch the discovery operation..."
cat /tools/sec-lists/Discovery/DNS/namelist.txt /tools/sec-lists/Discovery/DNS/subdomains-top1million-20000.txt | sort -u > /tmp/dico.txt
wfuzz -Z -c -w /tmp/dico.txt -H "Host: FUZZ$root_domain" --filter "$filter_opt" https://$ip

