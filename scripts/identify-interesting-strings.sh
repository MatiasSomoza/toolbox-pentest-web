#!/bin/bash
############################################################################
# Script to identify interesting strings contained in a binary file
############################################################################
if [ "$#" -lt 1 ]; then
    script_name=$(basename "$0")
    echo "Usage:"
    echo "   $script_name [BINARY_FILE_PATH]"
    echo ""
    echo "Call example:"
    echo "    $script_name /tmp/mybin"
	echo "    $script_name /tmp/mybin.exe"
    exit 1
fi
BIN_FILE=$1
PATTERNS=("LOGIN" "PASSWORD" "UserId" "Admin" "UID=" "DSN=" "DATABASE=" "PWD=" "Cookie:\s" "SESSIONID" "token" "Host:\s" "(GET|POST|PUT|PATCH|HEAD)\s" "(SELECT|UPDATE|DELETE|INSERT|CREATE)\s" "http[s]{0,1}://")
echo -e "\e[93m[+] Extract strings from '$BIN_FILE' ...\e[0m"
encodings=("l")
strings $BIN_FILE > /tmp/str.txt
for encoding in ${encodings[@]}; do
	strings -e $encoding $BIN_FILE >> /tmp/str.txt
done
wc -l /tmp/str.txt
for pattern in ${PATTERNS[@]}; do
  echo -e "\e[93m[+] Search for pattern '$pattern':\e[0m"
  grep --color -E $pattern /tmp/str.txt
done
